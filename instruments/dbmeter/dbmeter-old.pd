#N canvas 1302 381 555 588 10;
#X obj 264 474 send toGUI;
#X msg 264 450 list /readout \$1;
#X obj 264 84 adc~ 1;
#X floatatom 349 359 5 0 0 0 - - - 12;
#N canvas 0 0 450 300 (subpatch) 0;
#X array \$0-wfunc 2048 float 0;
#X coords 0 120 2047 0 512 100 1 0 0;
#X restore 584 251 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array \$0-hann 4096 float 0;
#X coords 0 1 4095 0 200 120 1;
#X restore 1101 869 graph;
#X msg 1041 869 0;
#X obj 925 942 osc~;
#X obj 925 869 samplerate~;
#X obj 925 965 *~ -0.5;
#X obj 925 988 +~ 0.5;
#X obj 907 1021 tabwrite~ \$0-hann;
#X obj 873 762 bng 19 250 50 0 empty empty empty 0 -6 0 8 #dfdfdf #000000 #000000;
#X obj 1016 711 loadbang;
#X obj 925 897 / 4096;
#X obj 1365 197 dbtorms~;
#X obj 1361 159 sig~;
#X obj 1380 266 numbox~ 4 15 100 #191919 #E1E1E1 10 0 0 0;
#X floatatom 1373 84 5 0 0 0 - - - 12;
#X msg 886 435 const 100;
#X obj 909 388 loadbang;
#X obj 876 487 s \$0-wfunc;
#X obj 264 324 env~ 4096 512;
#X floatatom 409 359 5 0 0 0 - - - 12;
#X obj 409 324 env~ 4096 512;
#N canvas 0 0 450 300 (subpatch) 0;
#X array \$0-magnitude 2048 float 0;
#X coords 0 1024 2047 0 512 100 1 0 0;
#X restore 584 72 graph;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-log_freq 1024 float 0;
#X coords 0 0 1023 -100 600 150 1 0 0;
#X restore 1554 460 graph;
#X text 2446 860 Nyquist;
#X text 1549 610 0;
#X text 1529 526 dB;
#N canvas 457 23 543 506 FFT 0;
#X obj 73 254 rfft~;
#X obj 73 156 inlet~;
#X obj 194 447 loadbang;
#X obj 194 472 tgl 15 0 empty empty empty 0 -6 0 10 #dcdcdc #000000 #000000 0 1;
#X obj 194 493 metro 205;
#X obj 118 535 tabwrite~ \$0-log_freq;
#N canvas 398 158 906 511 log_freq 0;
#X obj 37 43 inlet~;
#X obj 36 465 outlet~;
#X obj 36 196 tabreceive~ \$0-log_index;
#X obj 246 194 tabwrite \$0-log_index;
#X obj 218 95 loadbang;
#X obj 81 285 cnv 15 298 148 empty empty empty 20 12 0 14 #dcdcdc #404040 0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-log_index 1024 float 0;
#X coords 0 1024 1023 0 300 150 1;
#X restore 80 284 graph;
#X obj 196 96 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X obj 37 121 tabsend~ \$0-Amp;
#X obj 37 157 table \$0-Amp 1024;
#X obj 36 228 tabread4~ \$0-Amp;
#X obj 612 325 expr pow(2 \, $f1/12);
#X floatatom 612 301 0 0 12 0 - - - 0;
#X floatatom 612 348 0 0 0 0 - - - 0;
#X obj 218 149 expr pow(1023 \, $f1/1022) \; $f1 + 1;
#X obj 615 281 hsl 128 15 0 12 0 0 empty empty empty -2 -8 0 10 #dcdcdc #000000 #000000 0 1;
#X obj 218 121 loop 1023;
#X text 539 300 semitones;
#X text 568 348 ratio;
#X text 451 170 Let's go back to the theory of musical intervals. Below we have a division of the octave in 12 parts \, so an input in semitones from 0 to 12 is converted to logarhythmic ratios as below (we just adapt this to a wider range that depends on the index values \, see to the left).;
#X text 451 93 The array named "\$0-log_index" loads values of a logarhythmic scale used as indexes to read the FFT data \, which is stored in a table named "\$0-Amp" via the [tabsend~] object. In this way \, [tabreceive~ \$0-log_index] throws the table indexes and we use them to access the FFT with [tabread4~ \$0-Amp].;
#X connect 0 0 8 0;
#X connect 2 0 10 0;
#X connect 4 0 16 0;
#X connect 7 0 16 0;
#X connect 10 0 1 0;
#X connect 11 0 13 0;
#X connect 12 0 11 0;
#X connect 14 0 3 0;
#X connect 14 1 3 1;
#X connect 15 0 12 0;
#X connect 16 0 14 0;
#X restore 73 359 pd log_freq;
#X obj 73 448 lin2db~;
#X obj 73 299 mag~;
#X obj 73 480 max~ -100;
#X obj 73 208 hann~;
#X obj 73 118 block~ 8192 4;
#X obj 73 419 /~ 2048;
#X connect 0 0 8 0;
#X connect 0 1 8 1;
#X connect 1 0 10 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 6 0 12 0;
#X connect 7 0 9 0;
#X connect 8 0 6 0;
#X connect 9 0 5 0;
#X connect 10 0 0 0;
#X connect 12 0 7 0;
#X restore 1713 337 pd FFT;
#X obj 1692 374 out~;
#X text 1761 336 <= Open;
#X text 1539 454 0;
#X text 1515 602 -100;
#N canvas 353 76 558 670 FFT 1;
#X obj 32 142 *~, f 14;
#X obj 32 105 inlet~;
#X obj 32 176 rfft~, f 12;
#X obj 93 105 tabreceive~ \$0-hann;
#X obj 32 213 *~;
#X obj 71 213 *~;
#X obj 39 615 *~;
#X obj 57 589 tabreceive~ \$0-hann;
#X obj 39 562 rifft~;
#X obj 39 644 outlet~;
#X text 315 316 divide by 3N/2 (factor of N because [rfft~] and [rifft~] aren't normalized \, and 3/2 is the gain of overlap-4 reconstruction when Hann window function is applied twice.), f 50;
#X obj 251 317 /~ 6144;
#X obj 251 284 dbtorms~;
#X obj 251 253 tabreceive~ \$0-wfunc;
#X obj 339 553 tabsend~ \$0-magnitude;
#X obj 694 394 rfft~;
#X obj 694 296 inlet~;
#X obj 771 656 loadbang;
#X obj 771 681 tgl 15 0 empty empty empty 0 -6 0 10 #dcdcdc #000000 #000000 0 1;
#X obj 771 702 metro 205;
#X obj 695 744 tabwrite~ \$0-log_freq;
#N canvas 398 158 906 511 log_freq 1;
#X obj 37 43 inlet~;
#X obj 36 465 outlet~;
#X obj 36 196 tabreceive~ \$0-log_index;
#X obj 218 196 tabwrite \$0-log_index;
#X obj 218 70 loadbang;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-log_index 1024 float 0;
#X coords 0 1024 1023 0 300 150 1;
#X restore 66 282 graph;
#X obj 196 96 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X obj 37 121 tabsend~ \$0-Amp;
#X obj 37 157 table \$0-Amp 1024;
#X obj 36 228 tabread4~ \$0-Amp;
#X obj 906 414 expr pow(2 \, $f1/12);
#X floatatom 906 390 0 0 12 0 - - - 0;
#X floatatom 906 437 0 0 0 0 - - - 0;
#X obj 218 149 expr pow(1023 \, $f1/1022) \; $f1 + 1, f 27;
#X obj 909 370 hsl 128 15 0 12 0 0 empty empty empty -2 -8 0 10 #dcdcdc #000000 #000000 0 1;
#X text 833 389 semitones;
#X text 862 437 ratio;
#X text 745 259 Let's go back to the theory of musical intervals. Below we have a division of the octave in 12 parts \, so an input in semitones from 0 to 12 is converted to logarhythmic ratios as below (we just adapt this to a wider range that depends on the index values \, see to the left).;
#X text 745 145 The array named "\$0-log_index" loads values of a logarhythmic scale used as indexes to read the FFT data \, which is stored in a table named "\$0-Amp" via the [tabsend~] object. In this way \, [tabreceive~ \$0-log_index] throws the table indexes and we use them to access the FFT with [tabread4~ \$0-Amp].;
#X obj 218 121 loop 4095;
#X connect 0 0 7 0;
#X connect 2 0 9 0;
#X connect 4 0 19 0;
#X connect 6 0 19 0;
#X connect 9 0 1 0;
#X connect 10 0 12 0;
#X connect 11 0 10 0;
#X connect 13 0 3 0;
#X connect 13 1 3 1;
#X connect 14 0 11 0;
#X connect 19 0 13 0;
#X restore 694 499 pd log_freq;
#X obj 694 588 lin2db~;
#X obj 694 439 mag~;
#X obj 694 620 max~ -100;
#X obj 694 348 hann~;
#X obj 32 249 +~;
#X obj 32 277 sqrt~;
#X obj 32 68 block~ 4096 4;
#X obj 694 528 /~ 1024;
#N canvas 398 158 906 511 log_freq 0;
#X obj 37 43 inlet~;
#X obj 36 465 outlet~;
#X obj 36 196 tabreceive~ \$0-log_index;
#X obj 218 196 tabwrite \$0-log_index;
#X obj 218 70 loadbang;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-log_index 1024 float 0;
#X coords 0 1024 1023 0 300 150 1;
#X restore 66 282 graph;
#X obj 196 96 bng 15 250 50 0 empty empty empty 17 7 0 10 #dcdcdc #000000 #000000;
#X obj 37 121 tabsend~ \$0-Amp;
#X obj 37 157 table \$0-Amp 1024;
#X obj 36 228 tabread4~ \$0-Amp;
#X obj 906 414 expr pow(2 \, $f1/12);
#X floatatom 906 390 0 0 12 0 - - - 0;
#X floatatom 906 437 0 0 0 0 - - - 0;
#X obj 218 149 expr pow(1023 \, $f1/1022) \; $f1 + 1, f 27;
#X obj 909 370 hsl 128 15 0 12 0 0 empty empty empty -2 -8 0 10 #dcdcdc #000000 #000000 0 1;
#X text 833 389 semitones;
#X text 862 437 ratio;
#X text 745 259 Let's go back to the theory of musical intervals. Below we have a division of the octave in 12 parts \, so an input in semitones from 0 to 12 is converted to logarhythmic ratios as below (we just adapt this to a wider range that depends on the index values \, see to the left).;
#X text 745 145 The array named "\$0-log_index" loads values of a logarhythmic scale used as indexes to read the FFT data \, which is stored in a table named "\$0-Amp" via the [tabsend~] object. In this way \, [tabreceive~ \$0-log_index] throws the table indexes and we use them to access the FFT with [tabread4~ \$0-Amp].;
#X obj 218 121 loop 4095;
#X connect 0 0 7 0;
#X connect 2 0 9 0;
#X connect 4 0 19 0;
#X connect 6 0 19 0;
#X connect 9 0 1 0;
#X connect 10 0 12 0;
#X connect 11 0 10 0;
#X connect 13 0 3 0;
#X connect 13 1 3 1;
#X connect 14 0 11 0;
#X connect 19 0 13 0;
#X restore 32 374 pd log_freq;
#X obj 32 422 /~ 1024;
#X obj 339 620 tabsend~ \$0-log_mag;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 2 0 4 0;
#X connect 2 0 4 1;
#X connect 2 1 5 0;
#X connect 2 1 5 1;
#X connect 3 0 0 1;
#X connect 4 0 26 0;
#X connect 5 0 26 1;
#X connect 6 0 9 0;
#X connect 7 0 6 1;
#X connect 8 0 6 0;
#X connect 12 0 11 0;
#X connect 13 0 12 0;
#X connect 15 0 23 0;
#X connect 15 1 23 1;
#X connect 16 0 25 0;
#X connect 17 0 18 0;
#X connect 18 0 19 0;
#X connect 19 0 20 0;
#X connect 21 0 29 0;
#X connect 22 0 24 0;
#X connect 23 0 21 0;
#X connect 24 0 20 0;
#X connect 25 0 15 0;
#X connect 26 0 27 0;
#X connect 27 0 14 0;
#X connect 27 0 30 0;
#X connect 29 0 22 0;
#X connect 30 0 31 0;
#X connect 31 0 32 0;
#X restore 264 197 pd FFT;
#X f 16;
#X obj 469 101 noise~;
#X connect 1 0 0 0;
#X connect 6 0 7 1 32.................o....74+++eJ....e9+++aC....;
#X connect 7 0 9 0;
#X connect 8 0 14 0;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 12 0 8 0;
#X connect 12 0 6 0;
#X connect 12 0 11 0;
#X connect 13 0 12 0;
#X connect 14 0 7 0;
#X connect 15 0 17 0;
#X connect 16 0 15 0;
#X connect 18 0 16 0;
#X connect 19 0 21 0;
#X connect 20 0 19 0;
#X connect 22 0 1 0;
#X connect 22 0 3 0;
#X connect 24 0 23 0;
#X connect 35 0 22 0;
#X connect 36 0 35 0;
#X connect 36 0 24 0;
